#pragma once
#include "EnterData.h"
#include "ReferenceForm.h"
#include "graphClass.h"
#include "myVector.h"

namespace courseWork {

	using namespace System;
	using namespace System::ComponentModel;
	using namespace System::Collections;
	using namespace System::Windows::Forms;
	using namespace System::Data;
	using namespace System::Drawing;
	using namespace System::Threading;
	using namespace System::IO;
	using namespace System::Resources;
	using namespace System::Reflection;

	/// <summary>
	/// Ñâîäêà äëÿ MainForm
	/// </summary>
	public ref class MainForm : public System::Windows::Forms::Form
	{
	public:
		MainForm(int th)
		{
			InitializeComponent();
			image = gcnew Bitmap(2900, 5000);
			graph.createGraphics(image);
			Theme = th;
		}
	protected:
		/// <summary>
		/// Îñâîáîäèòü âñå èñïîëüçóåìûå ğåñóğñû.
		/// </summary>
		~MainForm()
		{
			if (components)
			{
				delete components;
			}
		}


	private: System::Windows::Forms::PictureBox^ pictureBox1;
	private: System::Windows::Forms::DataGridView^ dataGridView1;
	private: System::Windows::Forms::Button^ clearButton;
	private: System::Windows::Forms::Button^ searchButton;




	private: System::Windows::Forms::MenuStrip^ menuStrip1;
	private: System::Windows::Forms::ToolStripMenuItem^ íàñòğîéêèToolStripMenuItem;


	private: System::Windows::Forms::OpenFileDialog^ openFileDialog1;
	private: System::Windows::Forms::SaveFileDialog^ saveFileDialog1;
	private: System::Windows::Forms::Timer^ timer1;
	private: System::Windows::Forms::ToolStripMenuItem^ toolStripMenuItem1;
	private: System::Windows::Forms::ToolStripMenuItem^ ğóññêèéToolStripMenuItem;
	private: System::Windows::Forms::ToolStripMenuItem^ áåëàğóñê³ToolStripMenuItem;
	private: System::Windows::Forms::ToolStripMenuItem^ englishToolStripMenuItem;
	private: System::Windows::Forms::ToolStripMenuItem^ òåìûToolStripMenuItem;
	private: System::Windows::Forms::ToolStripMenuItem^ ñâåòëàÿToolStripMenuItem;
	private: System::Windows::Forms::ToolStripMenuItem^ òåìíàÿToolStripMenuItem;
	private: System::Windows::Forms::ToolStripMenuItem^ pinkyToolStripMenuItem;
	private: System::Windows::Forms::TextBox^ textBoxPath;
	private: System::Windows::Forms::ToolStripMenuItem^ ôàéëToolStripMenuItem;
	private: System::Windows::Forms::ToolStripMenuItem^ ñîõğàíèòüÊàêToolStripMenuItem;
	private: System::Windows::Forms::ToolStripMenuItem^ îòêğûòüToolStripMenuItem1;
	private: System::Windows::Forms::ToolStripMenuItem^ ñîõğàíèòüToolStripMenuItem;
	private: System::Windows::Forms::Label^ label1;
	private: System::Windows::Forms::ToolStripMenuItem^ ñïğàâêàToolStripMenuItem;




	private: System::ComponentModel::IContainer^ components;


	protected:

	private:
		/// <summary>
		/// Îáÿçàòåëüíàÿ ïåğåìåííàÿ êîíñòğóêòîğà.
		/// </summary>


#pragma region Windows Form Designer generated code
		/// <summary>
		/// Òğåáóåìûé ìåòîä äëÿ ïîääåğæêè êîíñòğóêòîğà — íå èçìåíÿéòå 
		/// ñîäåğæèìîå ıòîãî ìåòîäà ñ ïîìîùüş ğåäàêòîğà êîäà.
		/// </summary>
		void InitializeComponent(void)
		{
			this->components = (gcnew System::ComponentModel::Container());
			System::ComponentModel::ComponentResourceManager^ resources = (gcnew System::ComponentModel::ComponentResourceManager(MainForm::typeid));
			this->pictureBox1 = (gcnew System::Windows::Forms::PictureBox());
			this->dataGridView1 = (gcnew System::Windows::Forms::DataGridView());
			this->clearButton = (gcnew System::Windows::Forms::Button());
			this->searchButton = (gcnew System::Windows::Forms::Button());
			this->menuStrip1 = (gcnew System::Windows::Forms::MenuStrip());
			this->íàñòğîéêèToolStripMenuItem = (gcnew System::Windows::Forms::ToolStripMenuItem());
			this->toolStripMenuItem1 = (gcnew System::Windows::Forms::ToolStripMenuItem());
			this->ğóññêèéToolStripMenuItem = (gcnew System::Windows::Forms::ToolStripMenuItem());
			this->áåëàğóñê³ToolStripMenuItem = (gcnew System::Windows::Forms::ToolStripMenuItem());
			this->englishToolStripMenuItem = (gcnew System::Windows::Forms::ToolStripMenuItem());
			this->òåìûToolStripMenuItem = (gcnew System::Windows::Forms::ToolStripMenuItem());
			this->ñâåòëàÿToolStripMenuItem = (gcnew System::Windows::Forms::ToolStripMenuItem());
			this->òåìíàÿToolStripMenuItem = (gcnew System::Windows::Forms::ToolStripMenuItem());
			this->pinkyToolStripMenuItem = (gcnew System::Windows::Forms::ToolStripMenuItem());
			this->ôàéëToolStripMenuItem = (gcnew System::Windows::Forms::ToolStripMenuItem());
			this->ñîõğàíèòüToolStripMenuItem = (gcnew System::Windows::Forms::ToolStripMenuItem());
			this->ñîõğàíèòüÊàêToolStripMenuItem = (gcnew System::Windows::Forms::ToolStripMenuItem());
			this->îòêğûòüToolStripMenuItem1 = (gcnew System::Windows::Forms::ToolStripMenuItem());
			this->ñïğàâêàToolStripMenuItem = (gcnew System::Windows::Forms::ToolStripMenuItem());
			this->openFileDialog1 = (gcnew System::Windows::Forms::OpenFileDialog());
			this->saveFileDialog1 = (gcnew System::Windows::Forms::SaveFileDialog());
			this->timer1 = (gcnew System::Windows::Forms::Timer(this->components));
			this->textBoxPath = (gcnew System::Windows::Forms::TextBox());
			this->label1 = (gcnew System::Windows::Forms::Label());
			(cli::safe_cast<System::ComponentModel::ISupportInitialize^>(this->pictureBox1))->BeginInit();
			(cli::safe_cast<System::ComponentModel::ISupportInitialize^>(this->dataGridView1))->BeginInit();
			this->menuStrip1->SuspendLayout();
			this->SuspendLayout();
			// 
			// pictureBox1
			// 
			resources->ApplyResources(this->pictureBox1, L"pictureBox1");
			this->pictureBox1->BackColor = System::Drawing::Color::White;
			this->pictureBox1->Cursor = System::Windows::Forms::Cursors::Default;
			this->pictureBox1->Name = L"pictureBox1";
			this->pictureBox1->TabStop = false;
			this->pictureBox1->MouseClick += gcnew System::Windows::Forms::MouseEventHandler(this, &MainForm::pictureBox1_MouseClick);
			this->pictureBox1->MouseDoubleClick += gcnew System::Windows::Forms::MouseEventHandler(this, &MainForm::pictureBox1_MouseDoubleClick);
			// 
			// dataGridView1
			// 
			resources->ApplyResources(this->dataGridView1, L"dataGridView1");
			this->dataGridView1->AutoSizeColumnsMode = System::Windows::Forms::DataGridViewAutoSizeColumnsMode::AllCellsExceptHeader;
			this->dataGridView1->AutoSizeRowsMode = System::Windows::Forms::DataGridViewAutoSizeRowsMode::AllCellsExceptHeaders;
			this->dataGridView1->BackgroundColor = System::Drawing::Color::Gainsboro;
			this->dataGridView1->ColumnHeadersHeightSizeMode = System::Windows::Forms::DataGridViewColumnHeadersHeightSizeMode::AutoSize;
			this->dataGridView1->Name = L"dataGridView1";
			this->dataGridView1->ReadOnly = true;
			this->dataGridView1->RowTemplate->Height = 24;
			// 
			// clearButton
			// 
			resources->ApplyResources(this->clearButton, L"clearButton");
			this->clearButton->BackColor = System::Drawing::Color::White;
			this->clearButton->Cursor = System::Windows::Forms::Cursors::Hand;
			this->clearButton->ForeColor = System::Drawing::Color::White;
			this->clearButton->Name = L"clearButton";
			this->clearButton->UseVisualStyleBackColor = false;
			this->clearButton->Click += gcnew System::EventHandler(this, &MainForm::clearButton_Click);
			// 
			// searchButton
			// 
			resources->ApplyResources(this->searchButton, L"searchButton");
			this->searchButton->Name = L"searchButton";
			this->searchButton->UseVisualStyleBackColor = false;
			this->searchButton->Click += gcnew System::EventHandler(this, &MainForm::searchButton_Click);
			// 
			// menuStrip1
			// 
			this->menuStrip1->BackColor = System::Drawing::Color::Transparent;
			this->menuStrip1->ImageScalingSize = System::Drawing::Size(20, 20);
			this->menuStrip1->Items->AddRange(gcnew cli::array< System::Windows::Forms::ToolStripItem^  >(3) {
				this->íàñòğîéêèToolStripMenuItem,
					this->ôàéëToolStripMenuItem, this->ñïğàâêàToolStripMenuItem
			});
			resources->ApplyResources(this->menuStrip1, L"menuStrip1");
			this->menuStrip1->Name = L"menuStrip1";
			// 
			// íàñòğîéêèToolStripMenuItem
			// 
			this->íàñòğîéêèToolStripMenuItem->DropDownItems->AddRange(gcnew cli::array< System::Windows::Forms::ToolStripItem^  >(2) {
				this->toolStripMenuItem1,
					this->òåìûToolStripMenuItem
			});
			this->íàñòğîéêèToolStripMenuItem->Name = L"íàñòğîéêèToolStripMenuItem";
			resources->ApplyResources(this->íàñòğîéêèToolStripMenuItem, L"íàñòğîéêèToolStripMenuItem");
			this->íàñòğîéêèToolStripMenuItem->DropDownClosed += gcnew System::EventHandler(this, &MainForm::íàñòğîéêèToolStripMenuItem_DropDownClosed);
			this->íàñòğîéêèToolStripMenuItem->DropDownOpened += gcnew System::EventHandler(this, &MainForm::íàñòğîéêèToolStripMenuItem_DropDownOpened);
			// 
			// toolStripMenuItem1
			// 
			this->toolStripMenuItem1->DropDownItems->AddRange(gcnew cli::array< System::Windows::Forms::ToolStripItem^  >(3) {
				this->ğóññêèéToolStripMenuItem,
					this->áåëàğóñê³ToolStripMenuItem, this->englishToolStripMenuItem
			});
			resources->ApplyResources(this->toolStripMenuItem1, L"toolStripMenuItem1");
			this->toolStripMenuItem1->Name = L"toolStripMenuItem1";
			// 
			// ğóññêèéToolStripMenuItem
			// 
			resources->ApplyResources(this->ğóññêèéToolStripMenuItem, L"ğóññêèéToolStripMenuItem");
			this->ğóññêèéToolStripMenuItem->Name = L"ğóññêèéToolStripMenuItem";
			this->ğóññêèéToolStripMenuItem->Click += gcnew System::EventHandler(this, &MainForm::ğóññêèéToolStripMenuItem_Click);
			// 
			// áåëàğóñê³ToolStripMenuItem
			// 
			resources->ApplyResources(this->áåëàğóñê³ToolStripMenuItem, L"áåëàğóñê³ToolStripMenuItem");
			this->áåëàğóñê³ToolStripMenuItem->Name = L"áåëàğóñê³ToolStripMenuItem";
			this->áåëàğóñê³ToolStripMenuItem->Click += gcnew System::EventHandler(this, &MainForm::áåëàğóñê³ToolStripMenuItem_Click);
			// 
			// englishToolStripMenuItem
			// 
			resources->ApplyResources(this->englishToolStripMenuItem, L"englishToolStripMenuItem");
			this->englishToolStripMenuItem->Name = L"englishToolStripMenuItem";
			this->englishToolStripMenuItem->Click += gcnew System::EventHandler(this, &MainForm::englishToolStripMenuItem_Click);
			// 
			// òåìûToolStripMenuItem
			// 
			this->òåìûToolStripMenuItem->DropDownItems->AddRange(gcnew cli::array< System::Windows::Forms::ToolStripItem^  >(3) {
				this->ñâåòëàÿToolStripMenuItem,
					this->òåìíàÿToolStripMenuItem, this->pinkyToolStripMenuItem
			});
			resources->ApplyResources(this->òåìûToolStripMenuItem, L"òåìûToolStripMenuItem");
			this->òåìûToolStripMenuItem->Name = L"òåìûToolStripMenuItem";
			// 
			// ñâåòëàÿToolStripMenuItem
			// 
			resources->ApplyResources(this->ñâåòëàÿToolStripMenuItem, L"ñâåòëàÿToolStripMenuItem");
			this->ñâåòëàÿToolStripMenuItem->Name = L"ñâåòëàÿToolStripMenuItem";
			this->ñâåòëàÿToolStripMenuItem->Click += gcnew System::EventHandler(this, &MainForm::ñâåòëàÿToolStripMenuItem_Click);
			// 
			// òåìíàÿToolStripMenuItem
			// 
			resources->ApplyResources(this->òåìíàÿToolStripMenuItem, L"òåìíàÿToolStripMenuItem");
			this->òåìíàÿToolStripMenuItem->Name = L"òåìíàÿToolStripMenuItem";
			this->òåìíàÿToolStripMenuItem->Click += gcnew System::EventHandler(this, &MainForm::òåìíàÿToolStripMenuItem_Click);
			// 
			// pinkyToolStripMenuItem
			// 
			resources->ApplyResources(this->pinkyToolStripMenuItem, L"pinkyToolStripMenuItem");
			this->pinkyToolStripMenuItem->Name = L"pinkyToolStripMenuItem";
			this->pinkyToolStripMenuItem->Click += gcnew System::EventHandler(this, &MainForm::pinkyToolStripMenuItem_Click);
			// 
			// ôàéëToolStripMenuItem
			// 
			this->ôàéëToolStripMenuItem->DropDownItems->AddRange(gcnew cli::array< System::Windows::Forms::ToolStripItem^  >(3) {
				this->ñîõğàíèòüToolStripMenuItem,
					this->ñîõğàíèòüÊàêToolStripMenuItem, this->îòêğûòüToolStripMenuItem1
			});
			resources->ApplyResources(this->ôàéëToolStripMenuItem, L"ôàéëToolStripMenuItem");
			this->ôàéëToolStripMenuItem->Name = L"ôàéëToolStripMenuItem";
			this->ôàéëToolStripMenuItem->DropDownClosed += gcnew System::EventHandler(this, &MainForm::ôàéëToolStripMenuItem_DropDownClosed);
			this->ôàéëToolStripMenuItem->DropDownOpened += gcnew System::EventHandler(this, &MainForm::ôàéëToolStripMenuItem_DropDownOpened);
			// 
			// ñîõğàíèòüToolStripMenuItem
			// 
			resources->ApplyResources(this->ñîõğàíèòüToolStripMenuItem, L"ñîõğàíèòüToolStripMenuItem");
			this->ñîõğàíèòüToolStripMenuItem->Name = L"ñîõğàíèòüToolStripMenuItem";
			this->ñîõğàíèòüToolStripMenuItem->Click += gcnew System::EventHandler(this, &MainForm::ñîõğàíèòüToolStripMenuItem_Click);
			// 
			// ñîõğàíèòüÊàêToolStripMenuItem
			// 
			resources->ApplyResources(this->ñîõğàíèòüÊàêToolStripMenuItem, L"ñîõğàíèòüÊàêToolStripMenuItem");
			this->ñîõğàíèòüÊàêToolStripMenuItem->Name = L"ñîõğàíèòüÊàêToolStripMenuItem";
			this->ñîõğàíèòüÊàêToolStripMenuItem->Click += gcnew System::EventHandler(this, &MainForm::ñîõğàíèòüÊàêToolStripMenuItem_Click);
			// 
			// îòêğûòüToolStripMenuItem1
			// 
			resources->ApplyResources(this->îòêğûòüToolStripMenuItem1, L"îòêğûòüToolStripMenuItem1");
			this->îòêğûòüToolStripMenuItem1->Name = L"îòêğûòüToolStripMenuItem1";
			this->îòêğûòüToolStripMenuItem1->Click += gcnew System::EventHandler(this, &MainForm::îòêğûòüToolStripMenuItem1_Click);
			// 
			// ñïğàâêàToolStripMenuItem
			// 
			resources->ApplyResources(this->ñïğàâêàToolStripMenuItem, L"ñïğàâêàToolStripMenuItem");
			this->ñïğàâêàToolStripMenuItem->Name = L"ñïğàâêàToolStripMenuItem";
			this->ñïğàâêàToolStripMenuItem->Click += gcnew System::EventHandler(this, &MainForm::ñïğàâêàToolStripMenuItem_Click);
			// 
			// openFileDialog1
			// 
			this->openFileDialog1->FileName = L"graph.gr";
			this->openFileDialog1->InitialDirectory = L"C:\\Users\\admin\\Desktop";
			this->openFileDialog1->RestoreDirectory = true;
			// 
			// saveFileDialog1
			// 
			this->saveFileDialog1->DefaultExt = L"gr";
			this->saveFileDialog1->FileName = L"graph.gr";
			resources->ApplyResources(this->saveFileDialog1, L"saveFileDialog1");
			this->saveFileDialog1->InitialDirectory = L"C:\\Users\\admin\\Desktop";
			// 
			// timer1
			// 
			this->timer1->Interval = 1000;
			this->timer1->Tick += gcnew System::EventHandler(this, &MainForm::timer1_Tick);
			// 
			// textBoxPath
			// 
			resources->ApplyResources(this->textBoxPath, L"textBoxPath");
			this->textBoxPath->BackColor = System::Drawing::Color::White;
			this->textBoxPath->Cursor = System::Windows::Forms::Cursors::Arrow;
			this->textBoxPath->Name = L"textBoxPath";
			this->textBoxPath->ReadOnly = true;
			this->textBoxPath->Click += gcnew System::EventHandler(this, &MainForm::textBoxPath_Click);
			// 
			// label1
			// 
			resources->ApplyResources(this->label1, L"label1");
			this->label1->BackColor = System::Drawing::Color::WhiteSmoke;
			this->label1->Name = L"label1";
			// 
			// MainForm
			// 
			this->AutoScaleMode = System::Windows::Forms::AutoScaleMode::None;
			this->BackColor = System::Drawing::Color::WhiteSmoke;
			resources->ApplyResources(this, L"$this");
			this->Controls->Add(this->label1);
			this->Controls->Add(this->textBoxPath);
			this->Controls->Add(this->dataGridView1);
			this->Controls->Add(this->searchButton);
			this->Controls->Add(this->clearButton);
			this->Controls->Add(this->pictureBox1);
			this->Controls->Add(this->menuStrip1);
			this->MainMenuStrip = this->menuStrip1;
			this->Name = L"MainForm";
			this->FormClosed += gcnew System::Windows::Forms::FormClosedEventHandler(this, &MainForm::MainForm_FormClosed);
			this->Load += gcnew System::EventHandler(this, &MainForm::MainForm_Load);
			(cli::safe_cast<System::ComponentModel::ISupportInitialize^>(this->pictureBox1))->EndInit();
			(cli::safe_cast<System::ComponentModel::ISupportInitialize^>(this->dataGridView1))->EndInit();
			this->menuStrip1->ResumeLayout(false);
			this->menuStrip1->PerformLayout();
			this->ResumeLayout(false);
			this->PerformLayout();

		}
#pragma endregion
	private: int Theme;  // ïåğåìåííàÿ îòâå÷àşùàÿ çà òåêóùóş òåìó îêíà
	private: Bitmap^ image; // ïåğåìåííàÿ òî÷å÷íîãî ğèñóíêà
	private: graph graph; // ñîçäàåì îáúåêò íàøåãî êëàññà graph
	private: Thread^ thread; // ñîçäàåì íîâûé ïîòîê ïğèëîæåíèÿ
	private: int graphIterator = 0; // ïåğåìåííàÿ îòâå÷àşùàÿ çà êîëè÷åñòâî âåğøèí
	private: myVector<int> arrX; // îáúåêò êëàññà myVector õğàíÿùèé êîîğäèíàòû ïî îñè x
	private: myVector<int> arrY; // îáúåêò êëàññà myVector õğàíÿùèé êîîğäèíàòû ïî îñè y
	private: int isHighlight = -1; // ïåğåìåííàÿ â êîòîğîé õğàíèòüñÿ âûáğàííàÿ ïîëüçîâàòåëåì âåğøèíà
		 // ResourceManager Êëàññ. Ïğåäñòàâëÿåò äèñïåò÷åğ ğåñóğñîâ, îáåñïå÷èâàşùèé óäîáíûé äîñòóï ê ğåñóğñàì,
		// ñâÿçàííûì ñ ÿçûêîì è ğåãèîíàëüíûìè ïàğàìåòğàìè, âî âğåìÿ âûïîëíåíèÿ.
	private: ResourceManager^ resourceManager = gcnew ResourceManager("courseWork.MainForm", Assembly::GetExecutingAssembly());
		   // ñîçäàåì ıêçåìïëÿğ îáúåêòà resource manager, â ïàğàìåòğàõ ïåğåäàåì ôàéë ğåñóğñîâ äëÿ òåêóùåé ôîğìû, à òàêæå ìåòîäîì Assembly::GetExecutingAssembly() ïåğåäàåì ñáîğêó, êîòîğàÿ ñîäåğæèò âûïîëíÿåìûé â òåêóùèé ìîìåíò êîä.
	private: ResourceManager^ myResourceManager = gcnew ResourceManager("courseWork.Ğåñóğñû", Assembly::GetExecutingAssembly()); // àíàëîãè÷íî òîëüêî ïåğåäàåì îáùèé äëÿ ïğîåêòà ôàéë ğåñóğñîâ

		   // Âîçíèêàåò ïğè êàæäîé çàãğóçêå ôîğìû ïîëüçîâàòåëåì
	private: System::Void MainForm_Load(System::Object^ sender, System::EventArgs^ e) {
		searchButton->Enabled = false; // îòêëş÷àåì êíîïêó ïîèñêà öèêëà
		searchButton->BackColor = ColorTranslator::FromHtml("#F9CC00"); // ìåíÿåì öâåò êíîïêè

		// îòêëş÷àåì êíîïêè ñîõğàíåíèÿ ãğàôà
		ñîõğàíèòüToolStripMenuItem->Enabled = false;
		ñîõğàíèòüÊàêToolStripMenuItem->Enabled = false;

		switch (Theme) // ïåğåäàåì â switch-case ïàğàìåòğ Theme
		{
		case 0: // åñëè êîä òåìû ğàâåí 0 òî åñòü ñâåòëîé
		{
			ñâåòëàÿToolStripMenuItem_Click(this, gcnew EventArgs()); // âûçûâàåì íàæàòèå íà êíîïêó ñìåíû òåìû íà ñâåòëóş
			break;
		}
		case 1: // åñëè òåìà òåìíàÿ
		{
			òåìíàÿToolStripMenuItem_Click(this, gcnew EventArgs()); // âûçûâàåì íàæàòèå íà êíîïêó ñìåíû òåìû íà òåìíóş
			break;
		}
		case 2: // åñëè òåìà ğîçîâàÿ
		{
			pinkyToolStripMenuItem_Click(this, gcnew EventArgs()); // âûçûâàåì íàæàòèå íà êíîïêó ñìåíû òåìû íà ğîçîâóş
			break;
		}
		}
	}
		   // Ïğîèñõîäèò ïğè íàæàòèè íà pictureBox1
	private: System::Void pictureBox1_MouseClick(System::Object^ sender, System::Windows::Forms::MouseEventArgs^ e) {
		for (int current = graphIterator - 1; current >= 0; current--)
		{ // ïğîõîäèì ïî âñåì âåğøèíàì
			if ((e->X >= arrX[current] - 40 && e->Y >= arrY[current] - 40) && (e->X <= arrX[current] + 40 && e->Y <= arrY[current] + 40))
			{ // ïğîâåğÿåì ïîïàë ëè ïîëüçîâàòåëü íà âåğøèíó â ğàäèóñå 40 ïèêñåëåé
				if ((e->X >= arrX[current] - 20 && e->Y >= arrY[current] - 20) && (e->X <= arrX[current] + 20 && e->Y <= arrY[current] + 20))
				{ // ïğîâåğÿåì ïîïàë ëè ïîëüçîâàòåëü ğîâíî íà âåğøèíó

					if (isHighlight > -1) // âûäåëåíà ëè âåğøèíà
					{
						if (isHighlight != current) // åñëè âûäåëàíà äî ıòîãî âåğøèíà ÍÅ ğàâíà òîëüêî ÷òî âûáğàííîé
						{
							int tmp = isHighlight;

							// ğèñóåì ëèíèş ìåæäó âåğøèíàìè
							graph.drawLine(arrX[tmp], arrY[tmp], isHighlight, arrX[current], arrY[current], current);

							// â ìàòğèöå ñìåæíîñòè ñòàâèì 1 íà ñîåäèíåííûõ âåğøèíàõ
							this->dataGridView1->Rows[isHighlight]->Cells[current]->Value = 1;
							this->dataGridView1->Rows[current]->Cells[isHighlight]->Value = 1;
						}
						else // åñëè ıòî òàê òî êğàñèì âåğøèíó â áåëûé
							graph.drawEllipse(Brushes::White, arrX[current], arrY[current], current);

						// è ñíèìàåì âûäåëåíèå
						isHighlight = -1;
					}
					else // âåğøèíà íå âûäåëåíà
					{
						//  òî êğàñèì åå
						graph.drawEllipse(Brushes::Aqua, arrX[current], arrY[current], current);
						isHighlight = current; // è ïîìåùàåì â ñîîòâåòñòâóşùóş ïåğåìåííóş
					}
				}
				goto n; // ïåğåäàåì óïğàâëåíèå ñòğî÷êå çàâåğøåíèÿ ìåòîäà
			}
			else
				continue; // ïğîäîëæàåì èòåğàöèş öèêëà
		}
		// åñëè ğÿäîì íåò âåğøèí
		arrX.push_back(e->X); // òî ïîìåùàåì êîîğäèíàòû â ïåğåìåííûå
		arrY.push_back(e->Y);
		graph.drawEllipse(Brushes::White, e->X, e->Y, graphIterator); // è ğèñóåì âåğøèíó

		this->dataGridView1->Columns->Add(graphIterator.ToString(), graphIterator.ToString()); // äîáàâëÿåì êîëîíêó è çàäàåì íàçâàíèå
		this->dataGridView1->Columns[graphIterator]->SortMode = DataGridViewColumnSortMode::NotSortable; // ïğèìåíÿåì íàñòğîéêó íå ñîğòèğóåìûé äëÿ êîëîíêè
		this->dataGridView1->Rows->Add(); // äîáàâëÿåì ñòğîêó
		this->dataGridView1->Rows[graphIterator]->HeaderCell->Value = Convert::ToString(graphIterator); // çàäàåì íàçâàíèå äëÿ ñòğîêè
		this->dataGridView1->Rows[graphIterator + 1]->Cells[graphIterator]->Value = Convert::ToString(graphIterator); // è äëÿ íèæíåé ãäå õğàíÿòñÿ äàííûå

		for (int i = 0; i < graphIterator + 1; i++) 
		{
			this->dataGridView1->Rows[graphIterator]->Cells[i]->Value = 0;
		}

		for (int i = graphIterator; i >= 0; i--)
		{
			this->dataGridView1->Rows[i]->Cells[graphIterator]->Value = 0;
		}

		graphIterator++;

		if (!searchButton->Enabled)
		{
			searchButton->Enabled = true;
			searchButton->BackColor = Color::Gold;
			ñîõğàíèòüToolStripMenuItem->Enabled = true;
			ñîõğàíèòüÊàêToolStripMenuItem->Enabled = true;
		}

	n:
		this->pictureBox1->Image = image;
	}

	private: System::Void pictureBox1_MouseDoubleClick(System::Object^ sender, System::Windows::Forms::MouseEventArgs^ e) {
		for (int current = graphIterator - 1; current >= 0; current--)
		{
			if ((e->X >= arrX[current] - 20 && e->Y >= arrY[current] - 20) && (e->X <= arrX[current] + 20 && e->Y <= arrY[current] + 20))
			{
				graph.drawEllipse(Brushes::Blue, arrX[current], arrY[current], current);
				this->pictureBox1->Image = image;

				isHighlight = -1;

				EnterData::str = dataGridView1->Rows[graphIterator]->Cells[current]->Value->ToString();

				EnterData^ f = gcnew EnterData(Theme);

				f->ShowDialog();

				dataGridView1->Rows[graphIterator]->Cells[current]->Value = EnterData::str;

				graph.drawEllipse(Brushes::White, arrX[current], arrY[current], current);
				pictureBox1->Image = image;
			}
		}
	}

	private: bool isButton2On = true;
	private: System::Void searchButton_Click(System::Object^ sender, System::EventArgs^ e) {
		if (isButton2On)
		{
			thread = gcnew Thread(gcnew ThreadStart(this, &MainForm::gamilton));
			thread->Start();

			this->searchButton->Text = myResourceManager->GetString("StopSearch");
			this->searchButton->BackColor = Color::LightCoral;

			pictureBox1->Enabled = false;

			isButton2On = false;
		}
		else
			ButtonOn();
	}

		   delegate void InvokeDelegateButtonOn();
	private: void ButtonOn()
	{

		this->searchButton->Text = resourceManager->GetString("$this.Text");
		this->searchButton->BackColor = Color::Gold;

		this->pictureBox1->Enabled = true;

		isButton2On = true;

		thread->Abort();
	}

	private: void gamilton()
	{
		isHighlight = -1;

		bool* visited = new bool[graphIterator];          // íîìåğ õîäà, íà êîòîğîì ïîñåùàåòñÿ âåğøèíà
		int* path = new int[graphIterator];				 // íîìåğà ïîñåùàåìûõ âåğøèí

		for (int i = 0; i < graphIterator; i++)
		{
			graph.drawEllipse(Brushes::White, arrX[i], arrY[i], i);
			visited[i] = true;
		}
		visited[0] = false;

		path[0] = 0;

		graph.drawEllipse(Brushes::Red, arrX[0], arrY[0], 0);

		this->pictureBox1->Image = image;

		if (GamiltonCycleSearch(visited, path, 1))
		{
			graph.drawEllipse(Brushes::Coral, arrX[path[graphIterator - 1]], arrY[path[graphIterator - 1]], path[graphIterator - 1]);
			String^ strfed;
			for (int i = 0; i < graphIterator; i++)
				strfed += path[i] + "->";
			strfed += "0";
			this->textBoxPath->BeginInvoke(gcnew InvokeDelegateSetTextToLable(this, &MainForm::SetTextToLable), strfed);
		}
		else
		{
			graph.drawEllipse(Brushes::White, arrX[0], arrY[0], 0);
			this->pictureBox1->Image = image;
			this->textBoxPath->BeginInvoke(gcnew InvokeDelegateSetTextToLable(this, &MainForm::SetTextToLable), myResourceManager->GetString("isNoHamiltonianCycle"));
		}

		delete[] visited;
		delete[] path;

		this->BeginInvoke(gcnew InvokeDelegateButtonOn(this, &MainForm::ButtonOn));
	}


		   delegate void InvokeDelegateSetTextToLable(System::String^ str);
	private: void SetTextToLable(System::String^ str) {
		this->textBoxPath->Text = str;
	}
		   // ğåêóğñèâíûé ïîèñê Ãàìèëüòîíîâ öèêëà
	private: bool GamiltonCycleSearch(bool* visited, int* path, int k)
	{
		int v; // èíäåêñ âåğøèíû
		bool isGamiltonCycle = false; // ïğèçíàê íàõîæäåíèÿ ïóòè, ñíà÷àëà - íå íàéäåíî
		for (v = 0; v < graphIterator && !isGamiltonCycle; v++) // îáõîä ìàòğèöû ïî âñåì âåğøèíàì è ïîêà íå íàéäåí ïóòü
		{
			if (visited[v]) // ïğîâåğÿåì ïîñåùåíà ëè v âåğøèíà
			{
				// åñëè âåğøèíà åùå íå ïîñåëåííàÿ, òî äîëæíû åå ïîìåòèòü êàê âîçìîæíóş äëÿ ïîñåùåíèÿ
				graph.drawEllipse(Brushes::Blue, arrX[v], arrY[v], v); // ïåğåğèñîâûâàåì âåğøèíó ñîçäàâàÿ ñèÿíèş îáâîäêó
				this->pictureBox1->Image = image; // ïğèìåíÿåì èçìåíåíèÿ ê pictureBox1

				Thread::Sleep(500); // îñòàíàâëèâàåì ïîòîê íà 500 ìë. äëÿ òîãî ÷òîáû èçìåíåíèÿ áûëè çàìåòíû
			}

			// åñòü ëè ğåáğî ìåæäó òåêóùåé âåğøèíîé è âåğøèíîé, íàéäåííîé ïğè ïğåäûäóùåì âûçîâå
			// òî, ïğîâåğÿåì ìàòğèöó ñìåæíîñòè ïî ñòğîêå [path[k - 1]] è ñòîëáöó [v]
			if (Convert::ToInt32(this->dataGridView1->Rows[path[k - 1]]->Cells[v]->Value) == 1)
			{
				if (k == graphIterator && v == 0) //åñëè îáîøëè âñå âåğøèíû è äîøëè äî íà÷àëüíîé,
					isGamiltonCycle = true;	// òî ïóòü íàéäåí
				else
				{
					if (visited[v])	// ôîğìèğóåì ïóòü, åñëè â âåğøèíå v åùå íå áûëè
					{
						graph.drawEllipse(Brushes::Coral, arrX[path[k - 1]], arrY[path[k - 1]], path[k - 1]); // ïîìå÷àåì ïğåäûäóùóş âåğøèíó êàê ïîñåùåííóş ñîçäàâàÿ êîğàëëîâóş îáâîäêó
						graph.drawEllipse(Brushes::Red, arrX[v], arrY[v], v); // à âåğøèíó v êàê âåğøèíó â êîòîğîé íàõîäèòüñÿ àëãîğèòì
						this->pictureBox1->Image = image; // ïğèìåíÿåì èçìåíåíèÿ ê pictureBox1

						// íå îñòàíàâëèâàåì àëãîğèòì ò.ê. èçìåíåíèÿ áóäóò âèäíû ïğè ïîèñêå âåğøèíû äëÿ âõîäà 

						visited[v] = false;	// ïîìå÷àåì âåğøèíó êàê ïîñåùåííóş
						path[k] = v; // çàíåñåíèå âåğøèíû â íàéäåííûé ïóòü

						isGamiltonCycle = GamiltonCycleSearch(visited, path, k + 1); // èùåì ñëåäóşùóş âåğøèíó

						if (!isGamiltonCycle) // ïğîâåğÿåì íàéäåí ëè Ãàìèëüòîíîâ öèêë
						{
							visited[v] = true; // åñëè ïóòü íå íàéäåí, òî ïîìå÷àåì òåêóùóş âåğøèíó, êàê íå ïğîéäåííóş

							Thread::Sleep(500); // îñòàíàâëèâàş ïîòîê íà 500 ìë. äëÿ òîãî ÷òîáû èçìåíåíèÿ áûëè çàìåòíû

							// àëãîğèòì âîçâğàùàòüñÿ íàçàä è ıòî íàäî ïîêàçàòü
							graph.drawEllipse(Brushes::Red, arrX[path[k - 1]], arrY[path[k - 1]], path[k - 1]); // ïîìå÷àåì ïğåäûäóùóş âåğøèíó êğàñíîé îáâîäêîé òåì ñàìûì ïîìå÷àÿ åå êàê âåğøèíó èç êîòîğîé èäåò ïîèñê
							graph.drawEllipse(Brushes::White, arrX[v], arrY[v], v); // ó òåêóùåé âåğøèíû óáèğàåì îáâîäêó

							this->pictureBox1->Image = image;
						}
					}
					else
						continue; // åñëè â âåğøèíå óæå áûëè, òî íà àíàëèç ñëåäóşùåé âåğøèíû
				}
			}
			else if (visited[v])
			{
				// åñëè âåğøèíà íå ñîåäèíåíà è ïğè ıòîì íå ïîñåùåíà
				graph.drawEllipse(Brushes::White, arrX[v], arrY[v], v); // ğèñóåì åé áåëóş îáâîäêó
				this->pictureBox1->Image = image;
			}
		}
		return isGamiltonCycle;	//âîçâğàùàåì íàøëè èëè íåò
	}

	private: System::Void clearButton_Click(System::Object^ sender, System::EventArgs^ e) {
		timer1->Enabled = false;

		if (thread != nullptr)
			ButtonOn();

		searchButton->Enabled = false;
		searchButton->BackColor = ColorTranslator::FromHtml("#F9CC00");

		ñîõğàíèòüToolStripMenuItem->Enabled = false;
		ñîõğàíèòüÊàêToolStripMenuItem->Enabled = false;

		graph.clear_graph();
		this->pictureBox1->Image = image;

		graphIterator = 0;

		arrX.Clear();
		arrY.Clear();

		this->dataGridView1->Columns->Clear();

		isHighlight = -1;
	}

	private: System::Void MainForm_FormClosed(System::Object^ sender, System::Windows::Forms::FormClosedEventArgs^ e) {
		try
		{
			thread->Abort();
		}
		catch (...) {};

		Application::Exit();
	}
	private: System::Void timer1_Tick(System::Object^ sender, System::EventArgs^ e) {
		ñîõğàíèòüToolStripMenuItem_Click(this, gcnew EventArgs());
	}
	private: System::Void ğóññêèéToolStripMenuItem_Click(System::Object^ sender, System::EventArgs^ e) {
		changeLang("");
	}
	private: System::Void áåëàğóñê³ToolStripMenuItem_Click(System::Object^ sender, System::EventArgs^ e) {
		changeLang("be");
	}
	private: System::Void englishToolStripMenuItem_Click(System::Object^ sender, System::EventArgs^ e) {
		changeLang("en");
	}
	private: void changeLang(String^ l) {
		Thread::CurrentThread->CurrentUICulture = gcnew Globalization::CultureInfo(l);
		Thread::CurrentThread->CurrentCulture = gcnew Globalization::CultureInfo(l);

		this->WindowState = System::Windows::Forms::FormWindowState::Normal;
		this->Width = 1397;
		this->Height = 766;

		this->Text = resourceManager->GetString("$this.Text");

		ComponentResourceManager^ resources = gcnew ComponentResourceManager(this->GetType());

		for each (Control ^ ct in Controls)
		{
			resources->ApplyResources(ct, ct->Name);
		}

		ğóññêèéToolStripMenuItem->Enabled = true;
		áåëàğóñê³ToolStripMenuItem->Enabled = true;
		englishToolStripMenuItem->Enabled = true;

		for each (ToolStripMenuItem ^ item in menuStrip1->Items)
		{
			applyLangToToolStripMenu(resources, item);
		}
	}
	private: void applyLangToToolStripMenu(ComponentResourceManager^ resources, ToolStripMenuItem^ item)
	{
		resources->ApplyResources(item, item->Name);
		for each (ToolStripMenuItem ^ itm in item->DropDownItems)
			applyLangToToolStripMenu(resources, itm);
	}
	private: System::Void ñâåòëàÿToolStripMenuItem_Click(System::Object^ sender, System::EventArgs^ e) {
		dataGridView1->BackgroundColor = Color::LightGray;
		íàñòğîéêèToolStripMenuItem->Image = Image::FromFile("Icon\\setting_black.png");
		textBoxPath->BackColor = Color::White;

		changeColor(Color::WhiteSmoke, Color::Black);

		ñâåòëàÿToolStripMenuItem->Enabled = false;
		Theme = 0;
	}
	private: System::Void òåìíàÿToolStripMenuItem_Click(System::Object^ sender, System::EventArgs^ e) {
		dataGridView1->BackgroundColor = Color::Gray;
		íàñòğîéêèToolStripMenuItem->Image = Image::FromFile("Icon\\setting_white.png");
		textBoxPath->BackColor = Color::DarkGray;

		changeColor(Color::DimGray, Color::White);

		òåìíàÿToolStripMenuItem->Enabled = false;
		Theme = 1;
	}
	private: System::Void pinkyToolStripMenuItem_Click(System::Object^ sender, System::EventArgs^ e) {
		dataGridView1->BackgroundColor = Color::Snow;
		íàñòğîéêèToolStripMenuItem->Image = Image::FromFile("Icon\\setting_black.png");
		textBoxPath->BackColor = Color::Snow;

		changeColor(Color::Lavender, Color::Black);

		pinkyToolStripMenuItem->Enabled = false;
		Theme = 2;
	}
	private: void changeColor(Color cl1, Color cl2) {
		this->BackColor = cl1;

		íàñòğîéêèToolStripMenuItem->ForeColor = cl2;
		ôàéëToolStripMenuItem->ForeColor = cl2;
		ñïğàâêàToolStripMenuItem->ForeColor = cl2;

		label1->BackColor = cl1;
		label1->ForeColor = cl2;

		textBoxPath->ForeColor = cl2;

		ñâåòëàÿToolStripMenuItem->Enabled = true;
		òåìíàÿToolStripMenuItem->Enabled = true;
		pinkyToolStripMenuItem->Enabled = true;
	}
	private: System::Void íàñòğîéêèToolStripMenuItem_DropDownOpened(System::Object^ sender, System::EventArgs^ e) {
		íàñòğîéêèToolStripMenuItem->ForeColor = Color::Black;
		íàñòğîéêèToolStripMenuItem->Image = Image::FromFile("Icon\\setting_black.png");
	}
	private: System::Void íàñòğîéêèToolStripMenuItem_DropDownClosed(System::Object^ sender, System::EventArgs^ e) {
		if (Theme == 1)
		{
			íàñòğîéêèToolStripMenuItem->ForeColor = Color::White;
			íàñòğîéêèToolStripMenuItem->Image = Image::FromFile("Icon\\setting_white.png");
		}
	}
	private: System::Void ôàéëToolStripMenuItem_DropDownOpened(System::Object^ sender, System::EventArgs^ e) {
		ôàéëToolStripMenuItem->ForeColor = Color::Black;
		ôàéëToolStripMenuItem->Image = Image::FromFile("Icon\\folder_open.png");
	}
	private: System::Void ôàéëToolStripMenuItem_DropDownClosed(System::Object^ sender, System::EventArgs^ e) {
		if (Theme == 1)
		{
			ôàéëToolStripMenuItem->ForeColor = Color::White;
		}
		ôàéëToolStripMenuItem->Image = Image::FromFile("Icon\\folder_close.png");
	}
	private: String^ Path;
	private: System::Void ñîõğàíèòüToolStripMenuItem_Click(System::Object^ sender, System::EventArgs^ e) {
		try
		{
			if (Path != nullptr)
			{
				StreamWriter^ sWriter = gcnew StreamWriter(saveFileDialog1->FileName, false);

				sWriter->Write(graphIterator + "\n");

				for (int i = 0; i < graphIterator - 1; i++)
					sWriter->Write(arrX[i] + " ");
				sWriter->Write(arrX[graphIterator - 1] + "\n");

				for (int i = 0; i < graphIterator - 1; i++)
					sWriter->Write(arrY[i] + " ");
				sWriter->Write(arrY[graphIterator - 1] + "\n");

				for (int i = 0; i <= graphIterator; i++)
				{
					for (int j = 0; j < graphIterator - 1; j++)
					{
						sWriter->Write(dataGridView1->Rows[i]->Cells[j]->Value + " ");
					}
					sWriter->Write(dataGridView1->Rows[i]->Cells[graphIterator - 1]->Value + "\n");
				}

				sWriter->WriteLine(isHighlight);

				sWriter->Close();
			}
			else
			{
				ñîõğàíèòüÊàêToolStripMenuItem_Click(this, gcnew EventArgs());
			}
		}
		catch (System::Exception^ ex)
		{
			MessageBox::Show(ex->Message->ToString()); //ïîìåùàåì òåêñò èñêëş÷åíèå â MessageBox()
		}
	}
	private: System::Void ñîõğàíèòüÊàêToolStripMenuItem_Click(System::Object^ sender, System::EventArgs^ e) {
		try
		{
			if (saveFileDialog1->ShowDialog() == System::Windows::Forms::DialogResult::OK)
			{
				StreamWriter^ sWriter = gcnew StreamWriter(saveFileDialog1->FileName, false);

				sWriter->Write(graphIterator + "\n");

				for (int i = 0; i < graphIterator - 1; i++)
					sWriter->Write(arrX[i] + " ");
				sWriter->Write(arrX[graphIterator - 1] + "\n");

				for (int i = 0; i < graphIterator - 1; i++)
					sWriter->Write(arrY[i] + " ");
				sWriter->Write(arrY[graphIterator - 1] + "\n");

				for (int i = 0; i <= graphIterator; i++)
				{
					for (int j = 0; j < graphIterator - 1; j++)
					{
						sWriter->Write(dataGridView1->Rows[i]->Cells[j]->Value + " ");
					}
					sWriter->Write(dataGridView1->Rows[i]->Cells[graphIterator - 1]->Value + "\n");
				}

				sWriter->WriteLine(isHighlight);

				sWriter->Close();

				Path = saveFileDialog1->FileName;
				timer1->Enabled = true;
			}
		}
		catch (System::Exception^ ex)
		{
			MessageBox::Show(ex->Message->ToString()); //ïîìåùàåì òåêñò èñêëş÷åíèå â MessageBox()
		}
	}
	private: System::Void îòêğûòüToolStripMenuItem1_Click(System::Object^ sender, System::EventArgs^ e) {
		try
		{
			if (openFileDialog1->ShowDialog() == System::Windows::Forms::DialogResult::OK)
			{
				StreamReader^ sReader = gcnew StreamReader(openFileDialog1->FileName);

				clearButton_Click(this, gcnew EventArgs());

				graphIterator = Convert::ToInt32(sReader->ReadLine());

				String^ str = sReader->ReadLine();

				array <String^>^ sss = str->Split(' ');

				for (int i = 0; i < sss->Length; i++)
					arrX.push_back(Convert::ToInt32(sss[i]));

				str = sReader->ReadLine();
				sss = str->Split(' ');

				for (int i = 0; i < sss->Length; i++)
					arrY.push_back(Convert::ToInt32(sss[i]));

				for (int i = 0; i < graphIterator; i++)
				{
					this->dataGridView1->Columns->Add(i.ToString(), i.ToString());
					this->dataGridView1->Columns[i]->SortMode = DataGridViewColumnSortMode::NotSortable;
					this->dataGridView1->Rows->Add();
					this->dataGridView1->Rows[i]->HeaderCell->Value = Convert::ToString(i);
				}

				for (int i = 0; i <= graphIterator; i++)
				{
					str = sReader->ReadLine();
					sss = str->Split(' ');

					for (int j = 0; j < sss->Length; j++)
						dataGridView1->Rows[i]->Cells[j]->Value = sss[j];
				}

				isHighlight = Convert::ToInt32(sReader->ReadLine());

				for (int i = 0; i < graphIterator; i++)
				{
					graph.drawEllipse(Brushes::White, arrX[i], arrY[i], i);

					for (int j = 0; j < graphIterator; j++)
						if (Convert::ToInt32(dataGridView1->Rows[i]->Cells[j]->Value) != 0)
							graph.drawLine(arrX[i], arrY[i], i, arrX[j], arrY[j], j);
				}

				if (isHighlight > -1)
				{
					int tmp = isHighlight;
					graph.drawEllipse(Brushes::Aqua, arrX[tmp], arrY[tmp], isHighlight);
				}

				sReader->Close();

				Path = openFileDialog1->FileName;

				searchButton->Enabled = true;
				searchButton->BackColor = Color::Gold;

				ñîõğàíèòüToolStripMenuItem->Enabled = true;
				ñîõğàíèòüÊàêToolStripMenuItem->Enabled = true;

				timer1->Enabled = true;
			}
		}
		catch (System::Exception^ ex)
		{
			MessageBox::Show(ex->Message->ToString()); //ïîìåùàåì òåêñò èñêëş÷åíèå â MessageBox()
		}
	}
	private: System::Void textBoxPath_Click(System::Object^ sender, System::EventArgs^ e) {
		textBoxPath->SelectAll();
		textBoxPath->Copy();
	}
	private: ReferenceForm^ form;
	private: System::Void ñïğàâêàToolStripMenuItem_Click(System::Object^ sender, System::EventArgs^ e) {
		if (form == nullptr || form->IsDisposed)
		{
			form = gcnew ReferenceForm(Theme);
			form->Show();
		}
		else
			form->Focus();
	}
	};
}